<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ładowanie... | Netivly Project</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/newsletter.css">
    <!-- Marked.js do Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Prism.js do kolorowania kodu -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        /* Specyficzne style dla czytelni */
        .reading-progress { position: fixed; top: 0; left: 0; width: 0%; height: 4px; background: var(--primary); z-index: 4000; transition: width 0.1s; }
        
        .article-layout { display: grid; grid-template-columns: 1fr 300px; gap: 60px; margin-top: 60px; }
        
        /* Styl treści Markdown */
        #post-content { font-size: 1.15rem; line-height: 1.8; color: var(--text-main); }
        #post-content h2 { margin: 45px 0 20px; font-size: 2rem; font-weight: 800; border-bottom: 2px solid var(--border); padding-bottom: 10px; }
        #post-content h3 { margin: 30px 0 15px; font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        #post-content p { margin-bottom: 25px; opacity: 0.9; }
        #post-content ul, #post-content ol { margin: 0 0 30px 25px; }
        #post-content li { margin-bottom: 10px; }
        
        /* Wygląd obrazków w artykule */
        #post-content img { width: 100%; border-radius: 24px; margin: 30px 0; box-shadow: var(--shadow); border: 1px solid var(--border); }
        
        /* Wyróżnione bloki (cytaty) */
        #post-content blockquote { background: rgba(37, 99, 235, 0.05); border-left: 5px solid var(--primary); padding: 25px 30px; border-radius: 0 20px 20px 0; margin: 40px 0; font-style: italic; color: var(--text-muted); }
        
        /* Sidebar w artykule */
        .article-sidebar { position: sticky; top: 120px; height: fit-content; }
        .author-box { background: var(--bg-card); padding: 30px; border-radius: 24px; border: 1px solid var(--border); box-shadow: var(--shadow); }
        
        @media (max-width: 1000px) {
            .article-layout { grid-template-columns: 1fr; }
            .article-sidebar { display: none; }
        }
    </style>
</head>

<!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JV5KR2DGE0"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JV5KR2DGE0');
    </script>

<body>
    <div class="reading-progress" id="progress-bar"></div>

    <header>
        <a href="index.html" class="logo">Net<span>ivly</span> Project</a>
        <nav>
            <ul class="nav-links" id="nav-menu">
                <li><a href="index.html">Start</a></li>
                <li><a href="akademia.html">Akademia</a></li>
                <li><a href="baza-wiedzy.html">Baza Wiedzy</a></li>
            </ul>
        </nav>
        <button id="theme-toggle">Tryb</button>
    </header>

    <!-- HEADER ARTYKUŁU -->
    <section class="hero-expanded" style="padding-bottom: 40px;">
        <div class="container" style="max-width: 900px;">
            <span id="post-tag" class="badge">KATEGORIA</span>
            <h1 id="post-title" style="margin-top: 20px;">Ładowanie tytułu...</h1>
            <p id="post-meta" style="margin-top: 20px; font-weight: 600; opacity: 0.7;"></p>
        </div>
    </section>

    <div class="container">
        <div class="article-layout">
            <!-- GŁÓWNA TREŚĆ -->
            <main>
                <article id="post-content">
                    <p>Przygotowywanie treści...</p>
                </article>
                
                <!-- Stopka artykułu -->
                <div style="margin-top: 80px; padding-top: 40px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                    <a href="baza-wiedzy.html" class="btn btn-outline">← Wróć do bazy</a>
                    <div class="social-links" style="margin:0">
                        <span style="font-size: 0.8rem; font-weight: 700; margin-right: 10px;">UDOSTĘPNIJ:</span>
                        <a href="https://x.com/netivly"><i class="fab fa-x-twitter"></i></a>
                        <a href="#"><i class="fab fa-facebook"></i></a>
                    </div>
                </div>
            </main>

            <!-- SIDEBAR -->
            <aside class="article-sidebar">
                <div class="author-box">
                    <div style="width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 800; font-size: 1.5rem; margin-bottom: 20px;">D</div>
                    <h4>Dawid Józef Sakowski</h4>
                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-top: 10px;">Założyciel Netivly Project. Pasjonat niezależności cyfrowej, sieci i systemów Linux.</p>
                </div>
                
                <div class="sidebar-box" style="margin-top: 30px; background: var(--primary); color: white; border: none;">
                    <h4>E-booki</h4>
                    <p style="font-size: 0.85rem; opacity: 0.9;">Chcesz pogłębić wiedzę? Sprawdź nasze profesjonalne e-booki.</p>
                    <a href="ebooki.html" class="btn" style="background: white; color: var(--primary); width: 100%; margin-top: 15px;">Zobacz ofertę</a>
                </div>
            </aside>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const postId = params.get('id');
            const contentDiv = document.getElementById('post-content');

            if (!postId) { window.location.href = '404.html'; return; }

            fetch('dane.json')
                .then(res => res.json())
                .then(data => {
                    const post = data.find(p => p.slug === postId);
                    if (post) {
                        document.title = `${post.tytul} | Netivly Project`;
                        document.getElementById('post-title').innerText = post.tytul;
                        document.getElementById('post-tag').innerText = post.kategoria;
                        document.getElementById('post-meta').innerText = `${post.data} • ${post.czasCzytania} czytania`;

                        fetch(`tresc/${post.slug}.md`)
                            .then(res => {
                                if(!res.ok) throw new Error();
                                return res.text();
                            })
                            .then(text => {
                                contentDiv.innerHTML = marked.parse(text);
                                // Re-inicjalizacja Prism.js dla nowych bloków kodu
                                Prism.highlightAll();
                            })
                            .catch(() => { contentDiv.innerHTML = "<h2>Błąd ładowania treści.</h2>"; });
                    } else { window.location.href = '404.html'; }
                });

            // Obsługa paska postępu
            window.onscroll = function() {
                let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                let scrolled = (winScroll / height) * 100;
                document.getElementById("progress-bar").style.width = scrolled + "%";
            };
        });
    </script>
    <script src="js/script.js"></script>
    <script src="js/database.js"></script>
</body>
</body>
</html>