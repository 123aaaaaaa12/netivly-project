<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ładowanie... | Netivly Project</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- STYLE -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/newsletter.css">
    
    <!-- Biblioteki zewnętrzne -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JV5KR2DGE0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JV5KR2DGE0');
    </script>

    <style>
        .reading-progress { position: fixed; top: 0; left: 0; width: 0%; height: 4px; background: var(--primary); z-index: 5000; pointer-events: none; }
        header { z-index: 3000; position: sticky; top: 0; }
        .article-layout { display: grid; grid-template-columns: 1fr 320px; gap: 60px; margin-top: 40px; }

        /* TYPOGRAFIA */
        #post-content { font-size: 1.15rem; line-height: 2; color: var(--text-main); text-align: left; word-wrap: break-word; }
        #post-content h2 { margin: 60px 0 25px; font-size: 2.2rem; font-weight: 800; letter-spacing: -1.2px; border-bottom: 2px solid var(--border); padding-bottom: 12px; scroll-margin-top: 100px; }
        #post-content h3 { margin: 40px 0 20px; font-size: 1.6rem; font-weight: 700; color: var(--primary); scroll-margin-top: 100px; }
        #post-content p { margin-bottom: 25px; opacity: 0.95; }
        #post-content blockquote { background: rgba(37, 99, 235, 0.05); border-left: 5px solid var(--primary); padding: 25px 30px; border-radius: 0 24px 24px 0; margin: 40px 0; font-style: italic; }
        #post-content pre { border-radius: 16px; margin: 30px 0; padding: 20px !important; overflow-x: auto; }

        /* SPIS TREŚCI */
        .toc-box { background: var(--bg-card); padding: 25px; border-radius: 24px; border: 1px solid var(--border); margin-bottom: 25px; position: sticky; top: 100px; }
        .toc-box h4 { font-size: 0.85rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; color: var(--primary); }
        #toc-list { list-style: none; padding: 0; }
        #toc-list li { margin-bottom: 10px; border-bottom: 1px solid var(--border); padding-bottom: 8px; }
        #toc-list a { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; transition: 0.3s; display: block; }
        #toc-list a:hover { color: var(--primary); transform: translateX(5px); }

        /* AUTOR BOX PREMIUM */
        .author-box-premium { background: var(--bg-card); padding: 30px; border-radius: 28px; border: 1px solid var(--border); box-shadow: var(--shadow); margin-bottom: 25px; }
        .author-header-flex { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .author-avatar-circle { width: 50px; height: 50px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1.2rem; flex-shrink: 0; }
        .author-subtitle { font-size: 0.7rem; font-weight: 800; text-transform: uppercase; color: var(--primary); letter-spacing: 1px; display: block; }
        .author-description { font-size: 0.85rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 15px; }
        .author-social-mini { display: flex; gap: 12px; padding-top: 15px; border-top: 1px solid var(--border); }
        .author-social-mini a { color: var(--text-muted); font-size: 1rem; transition: 0.3s; }
        .author-social-mini a:hover { color: var(--primary); transform: translateY(-2px); }

        @media (max-width: 1000px) {
            .article-layout { grid-template-columns: 1fr; }
            .article-sidebar { display: none; }
        }
    </style>
</head>

<body>
    <div class="reading-progress" id="progress-bar"></div>

    <header>
        <!-- 1. LOGO -->
        <a href="index.html" class="logo">Net<span>ivly</span> Project</a>

        <!-- 2. PRZYCISK HAMBURGERA (widoczny tylko na telefonie) -->
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- 3. NAWIGACJA -->
        <nav>
            <ul class="nav-links" id="nav-menu">
                <li><a href="index.html">Start</a></li>
                <li><a href="akademia.html">Materiały</a></li>
                <li><a href="baza-wiedzy.html">Baza Wiedzy</a></li>
                <li><a href="ebooki.html">E-booki</a></li>
                <li><a href="biznes.html">Dla Biznesu</a></li>
                <li><a href="o-projekcie.html">O Projekcie</a></li>
            </ul>
        </nav>

        <!-- 4. PRZYCISK TRYBU -->
        <button id="theme-toggle">Tryb</button>
    </header>

    <div class="container">
        <div style="margin-top: 40px;">
            <a href="baza-wiedzy.html" class="btn-back-premium" style="display: inline-flex; align-items: center; gap: 8px; color: var(--text-muted); font-weight: 700; text-decoration: none; transition: 0.3s;">
                <i class="fas fa-arrow-left"></i> Powrót do bazy
            </a>
        </div>

        <div class="article-layout">
            <main>
                <div style="margin-bottom: 50px;">
                    <span id="post-tag" class="badge">KATEGORIA</span>
                    <h1 id="post-title" style="font-size: 3.2rem; font-weight: 800; margin: 20px 0; letter-spacing: -2px; line-height: 1.1;">Ładowanie...</h1>
                    <p id="post-meta" style="font-weight: 600; opacity: 0.6; font-size: 0.9rem;"></p>
                </div>

                <article id="post-content">
                    <p>Przygotowywanie treści...</p>
                </article>
                
                <!-- SHARE CARD -->
                <div class="share-card-modern" style="background: var(--bg-card); padding: 30px; border-radius: 24px; border: 1px solid var(--border); margin-top: 60px;">
                    <div style="font-weight: 800; text-transform: uppercase; font-size: 0.8rem; color: var(--primary); margin-bottom: 15px;">Udostępnij wiedzę</div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="url-field" style="flex: 1; padding: 10px; border-radius: 10px; border: 1px solid var(--border); background: var(--bg-body); color: var(--text-main);" readonly>
                        <button id="copy-btn" style="padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 700;">Skopiuj link</button>
                    </div>
                </div>
            </main>

            <aside class="article-sidebar">
                <!-- SPIS TREŚCI -->
                <div class="toc-box">
                    <h4>Spis treści</h4>
                    <ul id="toc-list"></ul>
                </div>

                <!-- AUTOR PREMIUM -->
                <div class="author-box-premium">
                    <div class="author-header-flex">
                        <div class="author-avatar-circle">D</div>
                        <div>
                            <span class="author-subtitle">Założyciel</span>
                            <h4 style="font-size: 1rem; margin: 0;">Dawid Sakowski</h4>
                        </div>
                    </div>
                    <p class="author-description">Praktyk IT specjalizujący się w systemach Linux i architekturze bezpiecznych sieci.</p>
                    <div class="author-social-mini">
                        <a href="https://github.com/123aaaaaaa12" target="_blank"><i class="fab fa-github"></i></a>
                        <a href="https://x.com/netivly" target="_blank"><i class="fab fa-x-twitter"></i></a>
                        <a href="mailto:kontakt@netivly.pl"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
                
                <div class="sidebar-box" style="background: var(--primary); color: white; border: none; padding: 25px; border-radius: 24px;">
                    <h4 style="font-size: 0.9rem; text-transform: uppercase; margin-bottom: 10px;">E-booki</h4>
                    <p style="font-size: 0.8rem; opacity: 0.9; margin-bottom: 15px;">Poznaj nasze materiały techniczne.</p>
                    <a href="ebooki.html" class="btn" style="background: white; color: var(--primary); width: 100%; text-align: center; display: block; padding: 10px; border-radius: 10px; font-weight: 800; font-size: 0.8rem;">Zobacz listę</a>
                </div>
            </aside>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script src="js/database.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const postId = params.get('id');
            const contentDiv = document.getElementById('post-content');
            const tocList = document.getElementById('toc-list');
            const urlField = document.getElementById('url-field');

            if(urlField) urlField.value = window.location.href;
            if (!postId) { window.location.href = '404.html'; return; }

            fetch('dane.json')
                .then(res => res.json())
                .then(data => {
                    const post = data.find(p => p.slug === postId);
                    if (post) {
                        document.title = `${post.tytul} | Netivly Project`;
                        document.getElementById('post-title').innerText = post.tytul;
                        document.getElementById('post-tag').innerText = post.kategoria;
                        document.getElementById('post-meta').innerText = `${post.data} • ${post.czasCzytania} czytania`;
                        return fetch(`tresc/${post.slug}.md`);
                    } else { throw new Error('Not found'); }
                })
                .then(res => res.text())
                .then(text => {
                    contentDiv.innerHTML = marked.parse(text);
                    Prism.highlightAll();
                    generateToC();
                })
                .catch(() => { contentDiv.innerHTML = "<h2>Artykuł nie został odnaleziony.</h2>"; });

            function generateToC() {
                const headings = contentDiv.querySelectorAll('h2');
                if (headings.length === 0) { document.querySelector('.toc-box').style.display = 'none'; return; }
                headings.forEach((h, i) => {
                    h.id = `section-${i}`;
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = `#${h.id}`;
                    a.innerText = h.innerText;
                    a.onclick = (e) => { e.preventDefault(); h.scrollIntoView({ behavior: 'smooth' }); };
                    li.appendChild(a);
                    tocList.appendChild(li);
                });
            }

            const copyBtn = document.getElementById('copy-btn');
            if(copyBtn) {
                copyBtn.onclick = () => {
                    navigator.clipboard.writeText(urlField.value).then(() => {
                        copyBtn.innerText = "OK!";
                        setTimeout(() => { copyBtn.innerText = "Skopiuj link"; }, 2000);
                    });
                };
            }

            window.onscroll = () => {
                let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                document.getElementById("progress-bar").style.width = (winScroll / height) * 100 + "%";
            };
        });
    </script>
</body>
</html>